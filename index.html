<!DOCTYPE html>
<html>
<head>
    <title>Vimeo PostMessage Research</title>
</head>
<body>
    <h1>Testing Vimeo Player PostMessage API</h1>
    
    <iframe id="vimeo" 
            src="https://player.vimeo.com/video/935884964"
            width="640" 
            height="360"
            allow="autoplay; fullscreen">
    </iframe>

    <div id="results"></div>

    <script>
        const iframe = document.getElementById('vimeo');
        const results = document.getElementById('results');

        function log(message) {
            const div = document.createElement('div');
            div.textContent = message;
            results.appendChild(div);
        }

        // Listen for postMessage responses
        window.addEventListener('message', (event) => {
            if (event.origin === 'https://player.vimeo.com') {
                log('Received message: ' + JSON.stringify(event.data));
                
                // Check if sensitive data is being leaked
                const dataStr = JSON.stringify(event.data);
                if (dataStr.includes('token') || 
                    dataStr.includes('api') || 
                    dataStr.includes('key')) {
                    log('⚠️ POTENTIAL DATA LEAK: ' + dataStr);
                }
            }
        });

        // Wait for iframe to load
        setTimeout(() => {
            // Test legitimate Vimeo Player API methods
            const methods = [
                'getVideoTitle',
                'getVideoId', 
                'getDuration',
                'getCurrentTime'
            ];

            methods.forEach(method => {
                iframe.contentWindow.postMessage({
                    method: method
                }, 'https://player.vimeo.com');
            });
        }, 2000);
    </script>
</body>
</html>
