<!DOCTYPE html>
<html>
<head>
    <title>Get Authenticated Vimeo Config</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
        }
        .status {
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .authenticated {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .not-authenticated {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #0056b3;
        }
        pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
            font-size: 12px;
        }
        iframe {
            border: 2px solid #007bff;
            margin: 20px 0;
        }
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Vimeo Authenticated Config Extractor</h1>

    <div class="instructions">
        <h3>üìã Instructions:</h3>
        <ol>
            <li>Click "Open Player in New Tab" below</li>
            <li>In the new tab, make sure you're logged into Vimeo (check top-right corner)</li>
            <li>Press <strong>F12</strong> to open DevTools</li>
            <li>In the Console tab, type: <code>window.playerConfig.user</code></li>
            <li>If you see <code>{id: ..., logged_in: 1, ...}</code> you're authenticated!</li>
            <li>Then type: <code>copy(JSON.stringify(window.playerConfig, null, 2))</code></li>
            <li>Paste the result here ‚¨áÔ∏è</li>
        </ol>
    </div>

    <button onclick="openPlayer()">üöÄ Open Player in New Tab</button>
    <button onclick="openVimeoLogin()">üîê Open Vimeo Login</button>

    <div id="status"></div>

    <h3>Paste Authenticated Config Here:</h3>
    <textarea id="configInput" style="width: 100%; height: 200px; font-family: monospace; padding: 10px;" placeholder='Paste the playerConfig JSON here...'></textarea>
    <br>
    <button onclick="analyzeConfig()">üìä Analyze Config</button>
    <button onclick="clearAll()">üóëÔ∏è Clear</button>

    <div id="analysis"></div>
    <pre id="output"></pre>

    <script>
        function openPlayer() {
            window.open('https://player.vimeo.com/video/935884964', '_blank');
        }

        function openVimeoLogin() {
            window.open('https://vimeo.com/log_in', '_blank');
        }

        function analyzeConfig() {
            const input = document.getElementById('configInput').value;
            const statusDiv = document.getElementById('status');
            const analysisDiv = document.getElementById('analysis');
            const outputDiv = document.getElementById('output');

            if (!input.trim()) {
                alert('Please paste the playerConfig JSON first!');
                return;
            }

            try {
                const config = JSON.parse(input);
                
                // Check authentication
                const isAuthenticated = config.user && config.user.logged_in === 1;
                
                if (isAuthenticated) {
                    statusDiv.className = 'status authenticated';
                    statusDiv.innerHTML = `
                        ‚úÖ <strong>AUTHENTICATED</strong><br>
                        User ID: ${config.user.id}<br>
                        Account Type: ${config.user.account_type}
                    `;
                    
                    analysisDiv.innerHTML = `
                        <h3>üéØ Extracted Data:</h3>
                        <table border="1" cellpadding="10" style="border-collapse: collapse; width: 100%;">
                            <tr><th>Field</th><th>Value</th></tr>
                            <tr><td>User ID</td><td>${config.user.id}</td></tr>
                            <tr><td>Account Type</td><td>${config.user.account_type}</td></tr>
                            <tr><td>Logged In</td><td>${config.user.logged_in}</td></tr>
                            <tr><td>IP Address</td><td>${config.client?.ip || 'N/A'}</td></tr>
                            <tr><td>Country</td><td>${config.country || 'N/A'}</td></tr>
                            <tr><td>Session ID</td><td>${config.request?.session || 'N/A'}</td></tr>
                            <tr><td>Referrer</td><td>${config.request?.referrer || 'N/A'}</td></tr>
                            <tr><td>ATID</td><td>${config.request?.atid || 'N/A'}</td></tr>
                            <tr><td>Timestamp</td><td>${new Date((config.request?.timestamp || 0) * 1000).toISOString()}</td></tr>
                        </table>
                    `;
                } else {
                    statusDiv.className = 'status not-authenticated';
                    statusDiv.innerHTML = `
                        ‚ùå <strong>NOT AUTHENTICATED</strong><br>
                        This config is from an anonymous session.
                    `;
                    
                    analysisDiv.innerHTML = `
                        <h3>üéØ Extracted Data (Anonymous):</h3>
                        <table border="1" cellpadding="10" style="border-collapse: collapse; width: 100%;">
                            <tr><th>Field</th><th>Value</th></tr>
                            <tr><td>IP Address</td><td>${config.client?.ip || 'N/A'}</td></tr>
                            <tr><td>Country</td><td>${config.country || 'N/A'}</td></tr>
                            <tr><td>Session ID</td><td>${config.request?.session || 'N/A'}</td></tr>
                            <tr><td>Referrer</td><td>${config.request?.referrer || 'N/A'}</td></tr>
                            <tr><td>ATID</td><td>${config.request?.atid || 'N/A'}</td></tr>
                            <tr><td>Timestamp</td><td>${new Date((config.request?.timestamp || 0) * 1000).toISOString()}</td></tr>
                        </table>
                    `;
                }

                outputDiv.textContent = JSON.stringify(config, null, 2);
                
            } catch (error) {
                alert('Invalid JSON! Error: ' + error.message);
            }
        }

        function clearAll() {
            document.getElementById('configInput').value = '';
            document.getElementById('status').innerHTML = '';
            document.getElementById('analysis').innerHTML = '';
            document.getElementById('output').textContent = '';
        }
    </script>
</body>
</html>
